pipeline {
  agent any


  tools{
    nodejs 'NodeJS 17.1.0'
  }

  stages{
      stage("build"){
	  when{
	      changeset "**/result/**"
	  }

 	  steps{
	      echo 'Compiling result app..'
	      dir('worker'){
		sh 'npm install'
	     }
	  }
      }
     
      stage("test"){
	when{
	    changeset "**/result/**"
	}

	steps{
	    echo 'Running Unti Test on result app..'
	    dir('result'){
	      sh 'npm install'
	      sh 'npm test'
	    }
	}
      }
  }
}
